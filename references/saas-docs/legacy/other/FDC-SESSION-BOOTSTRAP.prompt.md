# FDC-SESSION-BOOTSTRAP.prompt.md
Founders Direct Cockpit 開発セッション共通起動プロンプト（v2.1）

【このファイルは、Claude Code / ChatGPT での開発開始メッセージとして使用する】

## 出力言語指定

以後、このプロジェクトに関するすべての回答・説明・レポートは、日本語で行ってください。
コード内コメントや識別子は英語でもよいが、解説テキスト・完了報告は必ず日本語とすること。


---

## 手順

1. `DOCS/FDC-GRAND-GUIDE.md` を読み込み、前提とルールを理解してください。
2. **必須:** `DOCS/HOW-TO-DEVELOP.md` を読み込み、技術的詳細・フェーズ完了報告フローを確認してください。
3. 私が指定する「フェーズ」「目的」「対象ファイル」の範囲内でのみ作業してください。
4. 1回の応答で扱うスコープは次に従ってください：
   - 対象ファイル：最大5つまで
   - 目的：1つに限定（例：Adminタブの表示制御のみ）
   - 既存appData構造・Workspace/RBAC設計を壊さない

---

## 🚦 フェーズ実行ポリシー

### 一括出力方針

Claude Codeは、フェーズ内で**途中確認を挟まず**、可能な限り一括で出力を完了させてください。
- 分割出力やEnter待ちは不要です。
- ただし、セキュリティ・RBAC関連フェーズでは、安全確認のため一時停止を推奨します。

### フェーズ完了と承認フロー

フェーズ完了後は、必ず「**完了報告テンプレート**（HOW-TO-DEVELOP.md 参照）」に沿って出力し、
**ChatGPT（統合エージェント）** が承認・統合返信を行うまで次フェーズに進まないこと。

1. **Claude Code** → 完了報告を提出
2. **ChatGPT** → 承認 or 修正指示を返信
3. **人間開発者** → 最終確認・コメント
4. **Claude Code** → （承認後）次フェーズ開始

### サブエージェント運用

複数エージェント（設計・テスト・ドキュメント）で分業する場合は、
**HOW-TO-DEVELOP.md の「🤖 サブエージェント運用ルール（正式正本）」** に従うこと。

---

## 出力フォーマット（必須）

次の形式で提案または変更内容を出力してください。

- 変更ファイル：
- 修正内容：
- 理由：
- 影響範囲：
- 推奨コマンド：（例：`npm run build`, `npm test`）

---

## 厳守すべき禁止事項

- `dist/` 以外の `.js` ファイル編集・新規作成
- localStorage への直接アクセスコードの追加
- 既存の型・キー名の破壊的変更
- プロジェクト全体の一括リライトや不要な整形
- Workspace / RBAC / セキュリティ設計と矛盾する実装
- mainブランチへの直接反映（統合レビューを必須とする）

---

## 使用例（人間側からの指示テンプレ）

例1: Phase 2（state.ts拡張）

> FDC-GRAND-GUIDE.md と HOW-TO-DEVELOP.md を前提に、
> Phase 2: `core/state.ts` に `UserRole` と `workspaceId` を追加し、
> 既存データと互換性のある初期値ロジックを提案してください。
> 上記フォーマットで出力してください。

例2: Phase 5（タブ表示制御）

> EXEC/MANAGER/MEMBER のロール仕様に基づき、
> Admin / Settings タブの表示制御のみを `main.ts` と関連ファイルに追加してください。
> 他の仕様は変更せず、上記フォーマットで出力してください。

---

## 🧩 Edit Policy（Phase 7 系フェーズ共通）

このセッションでは、以下のファイル／ディレクトリへの編集は **事前承認済み** とする。  
Claude Code は、これらの範囲について「Do you want to make this edit?」等の確認プロンプトを出さず、  
常に「Yes, allow all edits during this session」として自動適用してよい。

### ✅ 自動編集を許可する範囲
- `js/**`
- `api/**`
- `tests/**`
- `DOCS/**`

### 🚫 保護対象（自動編集禁止）
以下のファイル・ディレクトリは、**人間レビュー後の明示指示がある場合のみ変更可能**とする。  
Claude Code はこれらのファイルに対しては「提案のみ」を行い、自動適用してはならない。
- `boot.yaml`
- `HOW-TO-DEVELOP.md`
- `WORKSPACE-SECURITY-DESIGN.md`
- `.github/**`
- `legacy-php/**`

### ⚙️ 自動適用後の検証
自動適用した結果は、以下の3ステップで妥当性を確認すること。  
1. `npm run type-check` が成功すること  
2. `npm run build` が成功すること  
3. `npm test` が成功すること  

### ⚠️ エラー時の対応
- バリデーションエラーが発生した場合は、該当箇所の差分を明示し、  
  ロールバック手順と修正提案を同時に提示すること。
- 一時的な修正であっても、保護対象ファイルへの自動編集は禁止。

---

これにより、Phase 7 系フェーズ（特に RBAC / UI 統合などの開発タスク）で  
途中で「Do you want to make this edit?」の確認が出ることはなくなる。
